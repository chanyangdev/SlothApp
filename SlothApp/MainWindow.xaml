<Window x:Class="SlothApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Sloth - 설치완료서류 도우미" Height="720" Width="1100"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Paths + selectors -->
        <GroupBox Header="Inputs" Padding="10" Margin="0,0,0,8">
            <Grid>
                <!-- add rows so controls don't overlap -->
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <!-- Config -->
                    <RowDefinition Height="Auto"/>
                    <!-- Excel -->
                    <RowDefinition Height="Auto"/>
                    <!-- Dest root -->
                    <RowDefinition Height="Auto"/>
                    <!-- Source folder -->
                    <RowDefinition Height="Auto"/>
                    <!-- Log path -->
                    <RowDefinition Height="Auto"/>
                    <!-- Customer -->
                    <RowDefinition Height="Auto"/>
                    <!-- Doc code -->
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="160"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Config -->
                <TextBlock Text="Config (JSON)" VerticalAlignment="Center"/>
                <TextBox x:Name="TxtConfig" Grid.Column="1" Margin="8,0"/>
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button Content="Browse…" Margin="0,0,6,0" Click="BrowseConfig_Click"/>
                    <Button Content="Load" Click="LoadConfig_Click"/>
                </StackPanel>

                <!-- Excel -->
                <TextBlock Grid.Row="1" Text="Customers Excel" VerticalAlignment="Center"/>
                <TextBox  x:Name="TxtExcel" Grid.Row="1" Grid.Column="1" Margin="8,4"/>
                <StackPanel Grid.Row="1" Grid.Column="2" Orientation="Horizontal">
                    <Button Content="Browse…" Margin="0,0,6,0" Click="BrowseExcel_Click"/>
                    <Button Content="Load" Click="LoadCustomers_Click"/>
                </StackPanel>

                <!-- Dest root -->
                <TextBlock Grid.Row="2" Text="Dest Root" VerticalAlignment="Center"/>
                <TextBox  x:Name="TxtDestRoot" Grid.Row="2" Grid.Column="1" Margin="8,4"/>
                <Button   Grid.Row="2" Grid.Column="2" Content="Browse…" Click="BrowseDestRoot_Click"/>

                <!-- Source folder -->
                <TextBlock Grid.Row="3" Text="Source Files Folder" VerticalAlignment="Center"/>
                <TextBox  x:Name="TxtSrcDir" Grid.Row="3" Grid.Column="1" Margin="8,4"/>
                <Button   Grid.Row="3" Grid.Column="2" Content="Browse…" Click="BrowseSrcDir_Click"/>

                <!-- Log file -->
                <TextBlock Grid.Row="4" Text="Log (xlsx) on Run" VerticalAlignment="Center"/>
                <TextBox  x:Name="TxtLogPath" Grid.Row="4" Grid.Column="1" Margin="8,4"/>
                <Button   Grid.Row="4" Grid.Column="2" Content="Save As…" Click="BrowseLog_Click"/>

                <!-- Customer & Doc -->
                <TextBlock Grid.Row="5" Text="Customer" VerticalAlignment="Center"/>
                <ComboBox x:Name="CmbCustomer"
              Grid.Row="5" Grid.Column="1" Margin="8,4"
              DisplayMemberPath="Name"
              SelectedValuePath="CustomerId"
              SelectionChanged="CmbCustomer_SelectionChanged"/>

                <TextBlock Grid.Row="6" Text="Doc Code" VerticalAlignment="Center"/>
                <ComboBox x:Name="CmbDocCode"
              Grid.Row="6" Grid.Column="1" Margin="8,4"/>
            </Grid>
        </GroupBox>


        <!-- Status -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,8">
            <TextBlock Text="Config sets: " VerticalAlignment="Center"/>
            <TextBlock x:Name="LblSets" FontWeight="Bold" Margin="6,0"/>
            <TextBlock Text=" | Customers: " Margin="12,0,0,0" VerticalAlignment="Center"/>
            <TextBlock x:Name="LblCustomers" FontWeight="Bold" Margin="6,0"/>
        </StackPanel>

        <!-- Batch Worklist -->
        <GroupBox Header="Batch Worklist" Grid.Row="1" Margin="0,0,0,8">
            <Grid Margin="8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <TextBlock Grid.ColumnSpan="3" Text="Select multiple Customers and Doc Codes, then Add to Queue." Margin="0,0,0,8" />

                <!-- Customers -->
                <GroupBox Header="Customers" Grid.Row="1" Grid.Column="0" Margin="0,0,8,0">
                    <ListBox x:Name="LbCustomers" SelectionMode="Extended" DisplayMemberPath="Name" />
                </GroupBox>

                <!-- Doc Codes -->
                <GroupBox Header="Doc Codes" Grid.Row="1" Grid.Column="1" Margin="0,0,8,0">
                    <DockPanel>
                        <CheckBox x:Name="ChkAutoDoc" Content="Use Auto (filename→docCode)" Margin="0,0,0,6"/>
                        <ListBox x:Name="LbDocCodes" SelectionMode="Extended" />
                    </DockPanel>
                </GroupBox>

                <StackPanel Grid.Row="1" Grid.Column="2" Orientation="Vertical" HorizontalAlignment="Right">
                    <Button Content="Add →" Width="120" Margin="0,0,0,6" Click="AddToQueue_Click"/>
                </StackPanel>

                <!-- Queue -->
                <DataGrid Grid.Row="3" Grid.ColumnSpan="3" x:Name="GridQueue" AutoGenerateColumns="False" CanUserAddRows="False" Height="160">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Customer" Binding="{Binding CustomerName}" Width="*" />
                        <DataGridTextColumn Header="CustomerId" Binding="{Binding CustomerId}" Width="120" />
                        <DataGridTextColumn Header="DocCode" Binding="{Binding DocCode}" Width="200" />
                        <DataGridTextColumn Header="SourceDir" Binding="{Binding SourceDir}" Width="*" />
                    </DataGrid.Columns>
                </DataGrid>

                <StackPanel Grid.Row="2" Grid.ColumnSpan="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,8">
                    <Button Content="Remove Selected" Margin="0,0,8,0" Click="RemoveSelectedQueue_Click"/>
                    <Button Content="Clear" Click="ClearQueue_Click"/>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- Results -->
        <DataGrid Grid.Row="2" x:Name="GridResults" AutoGenerateColumns="False" CanUserAddRows="False" ItemsSource="{Binding}">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Kind" Binding="{Binding Message}" Width="120"/>
                <DataGridTextColumn Header="Customer" Binding="{Binding CustomerName}" Width="180"/>
                <DataGridTextColumn Header="CustomerId" Binding="{Binding CustomerId}" Width="120"/>
                <DataGridTextColumn Header="DocCode" Binding="{Binding DocCode}" Width="160"/>
                <DataGridTextColumn Header="FileName" Binding="{Binding FileName}" Width="280"/>
                <DataGridTextColumn Header="SourcePath" Binding="{Binding SourcePath}" Width="*"/>
                <DataGridTextColumn Header="DestPath" Binding="{Binding DestPath}" Width="*"/>
                <DataGridCheckBoxColumn Header="Executed" Binding="{Binding Executed}" Width="90"/>
                <DataGridCheckBoxColumn Header="Success"  Binding="{Binding Success}"  Width="90"/>
            </DataGrid.Columns>
        </DataGrid>


        <!-- Actions -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
            <Button Content="Preview" Width="120" Margin="0,0,8,0" Click="Preview_Click"/>
            <Button Content="Run (Move + Log)" Width="160" Click="Run_Click"/>
        </StackPanel>
    </Grid>
</Window>
